# Agent Instruction for Linguisto

This document is a project guide prepared specifically for AI Agents to help you quickly understand how to install, build, and develop this project.

## Project Overview

**Linguisto** is a high-performance code language analysis tool built with Rust, providing Node.js bindings via [NAPI-RS](https://napi.rs/). It consists of two main parts:
1. **Rust CLI**: A standalone command-line tool.
2. **Node.js Addon**: A library that can be called within Node.js environments.

## Prerequisites

- **Rust**: Rust toolchain installed (latest stable recommended).
- **Node.js**: >= 10.0.0.
- **Package Manager**: `pnpm` is recommended.

## Installation

Run the following command in the project root:

```bash
# Install Node.js dependencies (including NAPI-RS CLI and development tools)
pnpm install
```

## Build Guide

### 1. Build Node.js Binary Bindings (.node files)

This process compiles Rust code into a module that Node.js can call.

```bash
# Build release version
pnpm run build

# Build debug version (faster, includes debug symbols)
pnpm run build:debug
```

The build artifacts will be generated based on your platform (e.g., `linguisto.darwin-arm64.node`).

### 2. Build Rust Binary CLI

If you only need to develop or run the native Rust CLI.

```bash
cargo build --release
```

## Development & Debugging

### Running the CLI

You can use `cargo run` to test the CLI logic locally.

```bash
# Analyze the current directory, limiting display to 6 languages
cargo run -- . --max-lang=6
```

### Running Tests

```bash
# Run Node.js side tests (using ava)
pnpm test
```

## Core Files

- `src/lib.rs`: The core entry point for NAPI-RS, defining the APIs exposed to JS (`analyzeDirectory`, `analyzeDirectorySync`).
- `src/main.rs`: Implementation logic for the Rust CLI.
- `index.js` / `index.d.ts`: Entry point and type definitions for Node.js (auto-generated by NAPI-RS).
- `package.json`: Defines build scripts and configuration for the npm package.

## Cheat Sheet

- Format Rust code: `cargo fmt`
- Format all code: `pnpm run format`
- Linting: `pnpm run lint`
